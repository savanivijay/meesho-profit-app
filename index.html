<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Meesho Seller Dashboard</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    body {
      font-family: 'Inter', sans-serif;
      background: #f9fafc;
      color: #333;
    }

    .dashboard-title {
      font-size: 30px;
      font-weight: 700;
      color: #0d6efd;
    }

    .upload-area {
      border: 2px dashed #0d6efd;
      border-radius: 16px;
      padding: 50px;
      text-align: center;
      background: #eaf1ff;
      transition: 0.3s;
      cursor: pointer;
    }

    .upload-area:hover {
      background: #d6e6ff;
    }

    .card-metric, .card-input {
      border: none;
      border-radius: 16px;
      padding: 20px;
      background: linear-gradient(to bottom right, #f0f6ff, #dbeafe);
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.04);
      text-align: center;
    }

    .metric-title {
      font-size: 15px;
      font-weight: 500;
      color: #555;
    }

    .metric-value {
      font-size: 26px;
      font-weight: 700;
      color: #0d6efd;
    }

    .section-title {
      font-size: 20px;
      font-weight: 600;
      margin-bottom: 15px;
    }

    .sku-table th {
      background-color: #0d6efd;
      color: white;
    }

    .input-box {
      font-size: 20px;
      font-weight: bold;
      color: #0d6efd;
    }

    .order-box {
      background: #fff;
      border-radius: 16px;
      padding: 20px;
      box-shadow: 0 0 10px rgba(0,0,0,0.04);
      text-align: center;
    }

    .order-box h6 {
      font-size: 14px;
      color: #666;
    }

    .order-box span {
      font-size: 22px;
      font-weight: 700;
    }
  </style>
</head>
<body>
  <div class="container my-5">
    <h2 class="text-center dashboard-title mb-4">üìä Meesho Seller Profit Dashboard</h2>

    <!-- Upload Area -->
    <div class="upload-area mb-5" onclick="document.getElementById('excelFile').click()">
      <h5 class="mb-2">üìÅ Click or Drag & Drop to Upload Meesho Excel File</h5>
      <input type="file" id="excelFile" accept=".xlsx" hidden />
    </div>

    <!-- Total Profit Display -->
    <div class="row mb-4">
      <div class="col-md-12">
        <div class="card-metric">
          <div class="metric-title">Total Net Profit</div>
          <div class="metric-value text-success" id="totalProfit">‚Çπ0</div>
        </div>
      </div>
    </div>

    <!-- Editable Input Metrics -->
    <div class="row g-4 mb-4">
      <div class="col-md-3">
        <div class="card-input">
          <div class="metric-title">Total Settlement (‚Çπ)</div>
          <input type="number" class="form-control text-center input-box" id="settlementInput" value="0">
        </div>
      </div>
      <div class="col-md-3">
        <div class="card-input">
          <div class="metric-title">Purchase Cost (‚Çπ)</div>
          <input type="number" class="form-control text-center input-box" id="purchaseCostInput" value="0">
        </div>
      </div>
      <div class="col-md-3">
        <div class="card-input">
          <div class="metric-title">Ad Cost (‚Çπ)</div>
          <input type="number" class="form-control text-center input-box" id="adCostInput" value="0">
        </div>
      </div>
      <div class="col-md-3">
        <div class="card-input">
          <div class="metric-title">Other Cost (‚Çπ)</div>
          <input type="number" class="form-control text-center input-box" id="otherCostInput" value="0">
        </div>
      </div>
    </div>

    <!-- Order Status Breakdown -->
    <div class="card mb-5 p-4">
      <h5 class="section-title">üì¶ Order Status Summary</h5>
      <div class="row g-4 text-center">
        <div class="col-md-2 col-6">
          <div class="order-box">
            <h6>Total Orders</h6>
            <span id="totalOrders">0</span>
          </div>
        </div>
        <div class="col-md-2 col-6">
          <div class="order-box">
            <h6>Delivered</h6>
            <span class="text-success" id="delivered">0</span>
          </div>
        </div>
        <div class="col-md-2 col-6">
          <div class="order-box">
            <h6>Return</h6>
            <span class="text-danger" id="returns">0</span>
          </div>
        </div>
        <div class="col-md-2 col-6">
          <div class="order-box">
            <h6>RTO</h6>
            <span class="text-warning" id="rto">0</span>
          </div>
        </div>
        <div class="col-md-2 col-6">
          <div class="order-box">
            <h6>Others</h6>
            <span id="others">0</span>
          </div>
        </div>
        <div class="col-md-2 col-6">
          <div class="order-box">
            <h6>Return Ratio</h6>
            <span id="returnRatio">0%</span>
          </div>
        </div>
      </div>
    </div>

    <!-- SKU Table -->
    <div class="card p-4">
      <h5 class="section-title">üìã SKU-wise Profit Analysis</h5>
      <div class="table-responsive">
        <table class="table sku-table table-bordered">
          <thead>
            <tr>
              <th>SKU</th>
              <th>Total Orders</th>
              <th>Delivered/Return/RTO</th>
              <th>Settlement</th>
              <th>Return Loss</th>
              <th>Cost Price</th>
              <th>Net Profit</th>
            </tr>
          </thead>
          <tbody id="skuTableBody">
            <tr><td colspan="7" class="text-center text-muted">No data uploaded</td></tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>

  <!-- Scripts -->
  <script src="https://cdn.jsdelivr.net/npm/xlsx/dist/xlsx.full.min.js"></script>
  <script>
    // Optional: Auto-calculate total profit based on inputs
    const updateProfit = () => {
      const settlement = parseFloat(document.getElementById("settlementInput").value) || 0;
      const purchase = parseFloat(document.getElementById("purchaseCostInput").value) || 0;
      const ad = parseFloat(document.getElementById("adCostInput").value) || 0;
      const other = parseFloat(document.getElementById("otherCostInput").value) || 0;
      const profit = settlement - purchase - ad - other;
      document.getElementById("totalProfit").textContent = `‚Çπ${profit.toLocaleString()}`;
    };

    document.querySelectorAll("input").forEach(input => {
      input.addEventListener("input", updateProfit);
    });

    updateProfit(); // Initial run
  </script>
</body>
</html>
